"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[72],{4416:(e,r,t)=>{t.d(r,{A:()=>a});let a=(0,t(2895).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},6072:(e,r,t)=>{t.r(r),t.d(r,{ImportProgramModal:()=>i});var a=t(5155),s=t(2115),l=t(9869),n=t(4416),d=t(2525),o=t(2056);function i(e){let{isOpen:r,onClose:t,onUpdateUserData:i,showToast:c}=e,u=(0,s.useRef)(null),x=(0,s.useRef)(null),[g,b]=(0,s.useState)(""),[m,h]=(0,s.useState)(null),[f,y]=(0,s.useState)("json");(0,s.useEffect)(()=>{let e=e=>{"Escape"===e.key&&t()},a=e=>{u.current&&!u.current.contains(e.target)&&t()};return r&&(document.body.style.overflow="hidden",document.addEventListener("keydown",e),document.addEventListener("mousedown",a)),()=>{document.body.style.overflow="",document.removeEventListener("keydown",e),document.removeEventListener("mousedown",a)}},[r,t]),(0,s.useEffect)(()=>{r&&(b(""),h(null),x.current&&(x.current.value=""),y("json"))},[r]);let p=async()=>{let e=null;if("json"===f&&g.trim())try{if(!(e=JSON.parse(g))||!Array.isArray(e.sessions))throw Error("ساختار JSON نامعتبر است.");e.sessions=e.sessions.map(e=>({...e,createdAt:new Date(e.createdAt||Date.now())}))}catch(e){c("خطا در تجزیه JSON: "+e.message,"delete");return}else if("file"!==f||!m)return void c("لطفاً کد JSON را وارد کنید یا یک فایل انتخاب کنید.","delete");else try{e=await (0,o.Xc)(m)}catch(e){c("خطا در وارد کردن فایل: "+e.message,"delete");return}e&&((0,o.Ts)(e),i(e),c("داده‌ها با موفقیت وارد شدند","success"),t())},k="json"===f&&!g.trim()||"file"===f&&!m;return r?(0,a.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 px-4",children:[" ",(0,a.jsxs)("div",{ref:u,className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-lg w-full max-h-[90vh] flex flex-col",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4 flex-shrink-0",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center space-x-2 space-x-reverse",children:[(0,a.jsx)(l.A,{className:"h-5 w-5 text-gray-700 dark:text-gray-300"}),(0,a.jsx)("span",{children:"وارد کردن برنامه"})]}),(0,a.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,a.jsx)(n.A,{className:"h-5 w-5"})})]}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4 text-right",children:"می‌توانید کد JSON برنامه را مستقیماً وارد کنید یا یک فایل JSON را آپلود کنید."}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("label",{className:"flex items-center text-sm font-medium text-gray-900 dark:text-white mb-2 cursor-pointer",children:[(0,a.jsx)("input",{type:"radio",name:"importMethod",value:"json",checked:"json"===f,onChange:()=>y("json"),className:"ml-2 h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),"کد JSON:"]}),(0,a.jsxs)("div",{className:"relative h-40",children:[" ",(0,a.jsx)("textarea",{id:"json-input",value:g,onChange:e=>{b(e.target.value)},placeholder:'{ "sessions": [...] }',rows:8,dir:"ltr",className:"w-full h-full px-3 py-2 border rounded-lg bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none pr-10\n                ".concat("json"===f?"border-gray-300 dark:border-gray-600":"border-gray-200 dark:border-gray-700 cursor-not-allowed opacity-70"),disabled:"json"!==f}),g.trim().length>0&&"json"===f&&(0,a.jsx)("button",{onClick:()=>{b("")},className:"absolute top-3 right-3 p-1 rounded-lg bg-red-100 dark:bg-red-900/20 text-red-600 dark:text-red-400 hover:bg-red-200 dark:hover:bg-red-900/40 transition-colors","aria-label":"پاک کردن کد JSON",children:(0,a.jsx)(d.A,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("label",{className:"flex items-center text-sm font-medium text-gray-900 dark:text-white mb-2 cursor-pointer",children:[(0,a.jsx)("input",{type:"radio",name:"importMethod",value:"file",checked:"file"===f,onChange:()=>y("file"),className:"ml-2 h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),"آپلود فایل JSON:"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 space-x-reverse bg-gray-100 dark:bg-gray-700 rounded-md p-2 w-full flex-nowrap",dir:"ltr",children:[(0,a.jsx)("input",{ref:x,id:"file-upload",type:"file",accept:".json",onChange:e=>{var r;h((null==(r=e.target.files)?void 0:r[0])||null)},className:"flex-grow text-gray-700 dark:text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-600 file:text-white hover:file:bg-blue-700 dark:file:bg-blue-800 dark:file:text-white dark:hover:file:bg-blue-900 min-w-0\n                ".concat("file"===f?"":"cursor-not-allowed opacity-70"),disabled:"file"!==f}),(0,a.jsx)("button",{onClick:()=>{h(null),x.current&&(x.current.value="")},disabled:!m||"file"!==f,className:"p-2 rounded-lg transition-colors flex-shrink-0 ".concat(m&&"file"===f?"bg-red-100 dark:bg-red-900/20 text-red-600 dark:text-red-400 hover:bg-red-200 dark:hover:bg-red-900/40":"bg-gray-200 dark:bg-gray-700 text-gray-400 dark:text-gray-500 cursor-not-allowed"),"aria-label":"حذف فایل انتخاب شده",children:(0,a.jsx)(d.A,{className:"h-5 w-5"})})]})]}),(0,a.jsx)("p",{className:"text-sm text-blue-500 dark:text-blue-400 mb-6 text-right",children:"ℹ️ داده‌های فعلی با داده‌های وارد شده جایگزین می‌شوند. این عملیات قابل بازگشت نیست."}),(0,a.jsxs)("div",{className:"flex space-x-3 space-x-reverse flex-shrink-0",children:[(0,a.jsx)("button",{onClick:p,disabled:k,className:"flex-1 px-4 py-2 rounded-lg transition-colors ".concat(k?"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-gray-700 dark:text-gray-400":"bg-blue-600 text-white hover:bg-blue-700"),children:"تأیید"}),(0,a.jsx)("button",{onClick:t,className:"flex-1 bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg hover:bg-gray-400 dark:hover:bg-gray-500 transition-colors",children:"لغو"})]})]})]}):null}}}]);